var g_storage=new myStorage,m=new lang,g_file_array,g_modal_url,g_modal_window_width=200,g_modal_window_height=80,g_show_modal=0;function closeJqmWindow(){var a=$("div#modalWindow");$("iframe",a).attr("src","");a&&a.jqmHide()}function resizeJqmWindow(a,c){var b=$(".jqmWindow");b&&(b.css("width",a+"px"),b.css("height",c+"px"))}function onMouseDownPicDIVHandler(a){if(a.button==2)return!1;openSelItem($(this).parents(".thumb-table-parent").find("a#list_item"))}
function openAudioPlayer(a){for(var c=[],b=0;b<g_file_array.length;b++)getFileExt(g_file_array[b].playhref)=="mp3"&&c.push(g_file_array[b]);if(c.length==0)alert(m.getString("msg_no_image_list"));else{for(var d="",e=0,b=0;b<c.length;b++){var f=c[b].playhref;a==f&&(e=b);d+=f;b!=c.length-1&&(d+=",")}c=$("div#modalWindow");g_modal_url="/smb/css/audio.html?a="+a+"&alist="+d+"&index="+e+"&s=0";g_modal_window_width=450;g_modal_window_height=152;$("#jqmMsg").css("display","none");$("#jqmTitleText").text(m.getString("title_audioplayer"));
c&&c.jqmShow()}}
function openImageViewer(a){for(var c=[],b=0;b<g_file_array.length;b++){var d=getFileExt(g_file_array[b].href);(d=="jpg"||d=="jpeg"||d=="png"||d=="gif")&&c.push(g_file_array[b])}if(c.length==0)alert(m.getString("msg_no_image_list"));else{for(b=d=0;b<c.length;b++)a==c[b].href&&(d=b);a="";b=getPageSize();a+='<div id="image_slide_show" class="barousel unselectable" style="height: 0; width: 0; position: fixed; background-color: rgb(0, 0, 0); left: '+b[0]/2+"px; top: "+b[1]/2+'px; z-index: 2999;">';a+=
'<div class="barousel_image">';for(b=0;b<c.length;b++){var e=c[b].href;a+=b==d?'<img src="" path="'+e+'" alt="" class="default"/>':'<img src="" path="'+e+'" alt="" class=""/>'}a+="</div>";a+='<div class="barousel_nav">';a+='<div class="barousel_content transparent" style="display: block; ">';for(b=0;b<c.length;b++)a+='<div class="',b==d&&(a+="default"),a+='" style="display: none; ">',a+='<p class="header">'+c[b].name+"</p>",a+="</div>";a+="</div>";a+="</div>";a+="</div>";$(a).animate({width:"100%",
height:"100%",left:"0px",top:"0px"},200,null,null).appendTo("body");$("#image_slide_show").barousel({navType:2,manualCarousel:1,contentResize:0,startIndex:d})}}
function openSelItem(a){var c=a.attr("uhref");a.attr("qtype");a.attr("isdir");a.attr("isusb");a.attr("uhref");var b=a.attr("playhref");a.attr("title");a=getFileExt(c);if((a=="mp4"||a=="m4v"||a=="wmv"||a=="avi"||a=="rmvb"||a=="rm"||a=="mpg"||a=="mpeg"||a=="mkv"||a=="mov"||a=="flv")&&isWinOS())if(isBrowser("msie")&&getInternetExplorerVersion()<=7)alert(m.getString("msg_vlcsupport"));else{c=$("div#modalWindow");b="/smb/css/vlc_video.html?v="+b;b+="&showbutton=1";g_modal_url=b;g_modal_window_width=655;
g_modal_window_height=480;$("#jqmMsg").css("display","none");$("#jqmTitleText").text(m.getString("title_videoplayer"));c&&c.jqmShow();return}if(a=="mp3")openAudioPlayer(b);else{if(a=="doc"||a=="docx"||a=="ppt"||a=="pptx"||a=="xls"||a=="xlsx"||a=="pdf")if((isWinOS()||isMacOS())&&!isPrivateIP()){window.open("https://docs.google.com/viewer?url="+c);return}a=="jpg"||a=="jpeg"||a=="png"||a=="gif"?openImageViewer(c):window.open(c)}}
$(document).ready(function(){document.oncontextmenu=function(){return!1};var a=String(window.navigator.userLanguage||window.navigator.language).toLowerCase(),a=g_storage.get("lan")==void 0?a:g_storage.get("lan");m.setLanguage(a);g_file_array=[];$("a#list_item").each(function(){g_file_array.push({href:$(this).attr("uhref"),playhref:$(this).attr("playhref")})});a="";a+="<div id='modalWindow' class='jqmWindow'>";a+="<div id='jqmTitle'>";a+="<span id='jqmTitleText'></span>";a+="</div>";a+="<div id='jqmMsg'>";
a+="<span id='jqmMsgText'></span>";a+="</div>";a+="<div id='jqmContent' style='padding;0px;margin:0px'>";a+="</div>";a+="</div>";$(a).appendTo($("body"));$("input.btnDownload").attr("value",m.getString("func_download"));$("input.btnDownloadAll").attr("value",m.getString("func_downloadall"));$(".picDiv").mousedown(onMouseDownPicDIVHandler);$("input.btnDownload").click(function(){var a=$(this).parents(".thumb-table-parent").find("a#list_item");window.open(a.attr("uhref"))});$("input.btnDownloadAll").click(function(){confirm(m.getString("msg_downloadall"))==
!0&&$("a#list_item").each(function(){window.open($(this).attr("uhref"))})});$("#modalWindow").jqm({overlay:70,modal:!0,target:"#jqmContent",onHide:function(a){$(a.w).fadeOut("2000",function(){a.o.remove();g_show_modal=0})},onShow:function(a){var a=$(a.w),b=$("#jqmContent",a);$("#jqmTitle",a);var d=(getPageSize()[0]-g_modal_window_width)/2;g_show_modal=1;navigator.userAgent.toLowerCase().indexOf("msie");var e=function(){var a=-1;navigator.appName=="Microsoft Internet Explorer"&&/MSIE ([0-9]{1,}[.0-9]{0,})/.exec(navigator.userAgent)!=
null&&(a=parseFloat(RegExp.$1));return a};g_modal_url!=""&&(b.empty(),$("<iframe src='' frameborder='0' width='100%' height='100%'>").appendTo(b),$("iframe",a).attr("src",g_modal_url));isBrowser("msie")&&e()<=8&&(g_modal_window_height+=25);a.css({width:g_modal_window_width,height:g_modal_window_height,left:d,top:-g_modal_window_height,opacity:0}).jqmShow().animate({width:g_modal_window_width,height:g_modal_window_height,top:0,left:d,marginLeft:0,opacity:1},200,function(){})}})});
